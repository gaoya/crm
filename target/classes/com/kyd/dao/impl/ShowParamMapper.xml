<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kyd.dao.ShowParamMapper">
    <update id="update" parameterType="java.util.Map">
        UPDATE sys_show_param
        <include refid="UPDATE_SQL"/>
        WHERE id=#{id}
    </update>

    <insert id="insert" parameterType="java.util.Map">
        INSERT  INTO
        sys_show_param
        (
            id,
            menu_Id,
            menu_code,
            p_id,
            p_name,
            p_placeholder,
            p_label,
            p_list,
            p_listdata,
            p_add,
            p_adddata,
            p_update,
            p_updatedata,
            p_detail,
            p_del,
            p_defaultvalue,
            p_user,
            p_time,
            p_sort,
            p_remark,
            p_search,
            p_searchdata
        )
        VALUES
        (
            #{id},
            #{menuId},
            #{menuCode},
            #{pId},
            #{pName},
            #{pPlaceholder},
            #{pLabel},
            #{pList},
            #{pListdata},
            #{pAdd},
            #{pAdddata},
            #{pUpdate},
            #{pUpdatedata},
            #{pDetail},
            #{pDel},
            #{pDefaultvalue},
            #{pUser},
            timestamp(now()),
            #{pSort},
            #{pRemark},
            #{pSearch},
            #{pSearchdata}
        )
    </insert>
    <delete id="deleteById" parameterType="java.lang.Long">
      DELETE  FROM sys_show_param
      WHERE ID=#{id}
    </delete>

    <select id="findById" parameterType="java.lang.Long" resultType="java.util.Map">
      SELECT
        <include refid="COLUMN_SQL"/>
      FROM sys_show_param
      WHERE ID=#{id}
    </select>

    <select id="findAllByParam" parameterType="java.util.Map" resultType="java.util.Map">
        SELECT
        <include refid="COLUMN_SQL"/>
        FROM sys_show_param
        WHERE 1 =1
        <include refid="WHERE_SQL"/>
        limit
        <choose>
            <when test="startIndex==null  or startIndex ==''">
                0
            </when>
            <otherwise>
                #{startIndex}
            </otherwise>
        </choose>
        ,
        <choose>
            <when test="endIndex==null or endIndex ==''">
                10
            </when>
            <otherwise>#{endIndex}</otherwise>
        </choose>
    </select>

    <select id="findCount" parameterType="java.util.Map" resultType="java.lang.Long">
        select COUNT(1) from sys_show_param
        WHERE 1=1
        <include refid="WHERE_SQL"/>
    </select>

    <select id="findAllByPageParam" parameterType="java.util.Map" resultType="java.util.Map">
        SELECT
        <include refid="COLUMN_SQL"/>
        FROM sys_show_param
        WHERE 1=1
        <include refid="WHERE_SQL"/>
        limit
        <choose>
            <when test="startIndex!=null  and startIndex !=''">
                #{startIndex}
            </when>
            <otherwise>
                0
            </otherwise>
        </choose>
        ,
        <choose>
            <when test="endIndex!=null and endIndex !=''">
                #{endIndex}
            </when>
            <otherwise>
                10
            </otherwise>
        </choose>
    </select>

    <select id="findCountByPageParam" parameterType="java.util.Map" resultType="java.lang.Long">
        SELECT COUNT(1) size
        FROM sys_show_param
        WHERE 1=1
        <include refid="WHERE_SQL"/>
    </select>

    <!-- 根据类型得到数据 -->
    <select id="findAllByMenuCodeAndType" parameterType="java.util.Map" resultType="java.util.Map">
        select
        <include refid="COLUMN_SQL"/>
        from
        SYS_SHOW_PARAM
        where
        ${pType} = #{pTypeValue}
        and (menu_code = #{menuCode} or lower (menu_code) = lower(#{menuCode}))
    </select>

    <sql id="COLUMN_SQL">
        ID AS ID,
        MENU_ID AS MENUID,
        MENU_CODE AS MENUCODE,
        P_ID AS PID,
        P_NAME AS PNAME,
        P_PLACEHOLDER AS PPLACEHOLDER,
        P_LABEL AS PLABEL,
        P_LIST AS PLIST,
        P_LISTDATA AS PLISTDATA,
        P_ADD AS PADD,
        P_ADDDATA AS PADDDATA,
        P_UPDATE AS PUPDATE,
        P_UPDATEDATA AS PUPDATEDATA,
        P_DETAIL AS PDETAIL,
        P_DEL AS PDEL,
        P_DEFAULTVALUE AS PDEFAULTVALUE,
        P_USER AS PUSER,
        P_TIME AS PTIME,
        P_SORT AS PSORT,
        P_REMARK AS PREMARK,
        P_SEARCH AS PSEARCH,
        P_SEARCHDATA AS PSEARCHDATA

    </sql>

    <sql id="WHERE_SQL">
        <if test="id != null and id!=''">AND id = #{id}</if>
        <if test="menuId != null and menuId != '' ">AND menu_Id = #{menuId}</if>
        <if test="menuCode != null and menuCode !=''">AND menu_code = #{menuCode}</if>
        <if test="pId != null and pId !=''">AND p_id = #{pId}</if>
        <if test="pName != null and pName!=''">AND p_name = #{pName}</if>
        <if test="pPlaceholder != null and pPlaceholder!=''">AND p_placeholder = #{pPlaceholder}</if>
        <if test="pLabel != null and pLabel!=''">AND p_label = #{pLabel}</if>
        <if test="pList != null and pList!=''">AND p_list = #{pList}</if>
        <if test="pListdata != null and pListdata!=''">AND p_listdata = #{pListdata}</if>
        <if test="pAdd != null and pAdd!=''">AND p_add = #{pAdd}</if>
        <if test="pAdddata != null and pAdddata!=''">AND p_adddata= #{pAdddata}</if>
        <if test="pUpdate != null and pUpdate!=''">AND p_update = #{pUpdate}</if>
        <if test="pUpdatedata != null and pUpdatedata!=''">AND p_updatedata = #{pUpdatedata}</if>
        <if test="pDetail != null and pDetail!=''">AND p_detail = #{pDetail}</if>
        <if test="pDel != null and pDel!=''">AND p_del = #{pDel}</if>
        <if test="pDefaultvalue != null and pDefaultvalue!=''">AND p_defaultvalue = #{pDefaultvalue}</if>
        <if test="pUser != null and pUser!=''">AND p_user = #{pUser}</if>
        <if test="pTime != null and pTime!=''">AND p_time = timestamp(now())</if>
        <if test="pSort != null and pSort!=''">AND p_sort = #{pSort}</if>
        <if test="pRemark != null and pRemark!=''">AND p_remark = #{pRemark}</if>
        <if test="pSearch != null and pSearch!=''">AND p_search = #{pSearch}</if>
        <if test="pSearchdata != null and pSearchdata!='' ">AND p_searchdata = #{pSearchdata}</if>

    </sql>

    <sql id="UPDATE_SQL">
        <set>
            <if test="id!=null and id!=''">id=#{id},</if>
            <if test="menuId!=null and menuId!=''">menu_Id=#{menuId},</if>
            <if test="menuCode!=null and menuCode!=''">menu_code=#{menuCode},</if>
            <if test="pId!=null and pId!=''">p_id=#{pId},</if>
            <if test="pName!=null and pName!=''">p_name=#{pName},</if>
            <if test="pPlaceholder!=null and pPlaceholder!=''">p_placeholder=#{pPlaceholder},</if>
            <if test="pLabel!=null and pLabel!=''">p_label=#{pLabel},</if>
            <if test="pList!=null and pList!=''">p_list=#{pList},</if>
            <if test="pListdata!=null and pListdata!=''">p_listdata=#{pListdata},</if>
            <if test="pAdd!=null and pAdd!=''">p_add=#{pAdd},</if>
            <if test="pAdddata!=null and pAdddata!=''">p_adddata=#{pAdddata},</if>
            <if test="pUpdate!=null and pUpdate!=''">p_update=#{pUpdate},</if>
            <if test="pUpdatedata!=null and pUpdatedata!=''">p_updatedata=#{pUpdatedata},</if>
            <if test="pDetail!=null and pDetail!=''">p_detail=#{pDetail},</if>
            <if test="pDel!=null an pDel!=''">p_del=#{pDel},</if>
            <if test="pDefaultvalue!=null and pDefaultvalue!=''">p_defaultvalue=#{pDefaultvalue},</if>
            <if test="pUser!=null and pUser!=''">p_user=#{pUser},</if>
            <if test="pTime!=null and pTime!=''">p_time=timestamp(now()),</if>
            <if test="pSort!=null and pSort!=''">p_sort=#{pSort},</if>
            <if test="pRemark!=null and pRemark!=''">p_remark=#{pRemark},</if>
            <if test="pSearch!=null and pSearch!=''">p_search=#{pSearch}</if>
            <if test="pSearchdata!=null and pSearchdata!=''">p_searchdata=#{pSearchdata}</if>
        </set>
    </sql>
</mapper>
